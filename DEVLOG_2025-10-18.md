# Aggiornamenti del 12 Ottobre 2025

## Gestione consegne e materiali
- Il cambio di stato a **“Sbagliato”** nel tab Materiali crea automaticamente una bozza di errore collegata alla busta e mostra un messaggio dedicato sull’ordine.
- L’avviso sull’ordine è stato semplificato: “⚠️ La bozza dell’errore è stata creata. Contatta un amministratore per completarla.”

## Tracciamento errori
- Introdotta la gestione completa delle bozze:
  - Le bozze vengono evidenziate e ordinate in cima alla lista `/errori`.
  - Gli amministratori possono aprirle direttamente nel modulo “Registra Errore”, completarle o eliminarle.
- Aggiornato il modulo rapido:
  - Supporto modalità bozza con campi precompilati e invio via `PATCH`.
  - Badge in sidebar aggiornato in tempo reale tramite eventi custom.
- Nuove rotte API `/api/error-tracking/drafts` con supporto a `GET`, `POST`, `PATCH`, `DELETE`.

## Lettere di richiamo
- Creata la tabella `warning_letters` (migrazione `migration_create_warning_letters.sql`) e aggiunto un campo `notes` per i richiami verbali (`migration_add_warning_letters_notes.sql`).
- I richiami verbali ora vengono registrati correttamente senza PDF.

## Note tecniche
- Aggiornato `types/database.types.ts` per includere `warning_letters`.
- Aggiunto fallback `loading.tsx` alla pagina `/errori` per la compatibilità con `useSearchParams`.
- Assicurata la propagazione degli eventi `CustomEvent('errorDrafts:update')` per mantenere in sync il badge in sidebar con le azioni sugli errori.
